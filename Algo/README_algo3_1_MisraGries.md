# Algorithm 3.1 — Misra–Gries (k-1 counters)

- 目的: ストリームから heavy hitters を近似抽出
- ルール: 既存なら+1 / 空きがあれば新規1 / 空きがなければ全カウンタを一括で-1し、0を削除
- メモリ: O(k)
- 1パス: O(nk) だが実装は単純（辞書+全体減算）
- 誤差保証: 出力候補 i の真の頻度 f(i) は `c[i] ≤ f(i) ≤ c[i] + ⌊n/k⌋`
- 長所: 簡潔、実装が短い、上位頻出に対して堅牢
- 短所: 一括減算がホットパス。k が大きいと減算コストが効く
- 運用Tips: キー集合が非常に大きく、上位少数が突出している状況で有効。k は画面に載る候補数+数割の余裕で選ぶ
- 代表用途: ログの人気URL、チャットの多投ユーザ検出、トークン頻度の先読み
